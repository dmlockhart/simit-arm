
/* IDEF (instruction, mask, signature, probability) */

/*
dpi opcode

and - 0x00
eor - 0x01
sub - 0x02
rsb - 0x03
add - 0x04
adc - 0x05
sbc - 0x06
rsc - 0x07
tst - 0x08
teq - 0x09
cmp - 0x0A
cmn - 0x0B
orr - 0x0C
mov - 0x0D
bic - 0x0E
mvn - 0x0F

*/

IDEF(and_1,  0x0FF00000, 0x02000000, 1)
IDEF(and_1s, 0x0FF00000, 0x02100000, 1)
IDEF(and_2,  0x0FF00010, 0x00000000, 1)
IDEF(and_2s, 0x0FF00010, 0x00100000, 1)
IDEF(and_3,  0x0FF00090, 0x00000010, 1)
IDEF(and_3s, 0x0FF00090, 0x00100010, 1)

IDEF(eor_1,  0x0FF00000, 0x02200000, 1)
IDEF(eor_1s, 0x0FF00000, 0x02300000, 1)
IDEF(eor_2,  0x0FF00010, 0x00200000, 1)
IDEF(eor_2s, 0x0FF00010, 0x00300000, 1)
IDEF(eor_3,  0x0FF00090, 0x00200010, 1)
IDEF(eor_3s, 0x0FF00090, 0x00300010, 1)

IDEF(sub_1,  0x0FF00000, 0x02400000, 1)
IDEF(sub_1s, 0x0FF00000, 0x02500000, 1)
IDEF(sub_2,  0x0FF00010, 0x00400000, 1)
IDEF(sub_2s, 0x0FF00010, 0x00500000, 1)
IDEF(sub_3,  0x0FF00090, 0x00400010, 1)
IDEF(sub_3s, 0x0FF00090, 0x00500010, 1)

IDEF(rsb_1,  0x0FF00000, 0x02600000, 1)
IDEF(rsb_1s, 0x0FF00000, 0x02700000, 1)
IDEF(rsb_2,  0x0FF00010, 0x00600000, 1)
IDEF(rsb_2s, 0x0FF00010, 0x00700000, 1)
IDEF(rsb_3,  0x0FF00090, 0x00600010, 1)
IDEF(rsb_3s, 0x0FF00090, 0x00700010, 1)

IDEF(add_1,  0x0FF00000, 0x02800000, 1)
IDEF(add_1s, 0x0FF00000, 0x02900000, 1)
IDEF(add_2,  0x0FF00010, 0x00800000, 1)
IDEF(add_2s, 0x0FF00010, 0x00900000, 1)
IDEF(add_3,  0x0FF00090, 0x00800010, 1)
IDEF(add_3s, 0x0FF00090, 0x00900010, 1)

IDEF(adc_1,  0x0FF00000, 0x02A00000, 1)
IDEF(adc_1s, 0x0FF00000, 0x02B00000, 1)
IDEF(adc_2,  0x0FF00010, 0x00A00000, 1)
IDEF(adc_2s, 0x0FF00010, 0x00B00000, 1)
IDEF(adc_3,  0x0FF00090, 0x00A00010, 1)
IDEF(adc_3s, 0x0FF00090, 0x00B00010, 1)

IDEF(sbc_1,  0x0FF00000, 0x02C00000, 1)
IDEF(sbc_1s, 0x0FF00000, 0x02D00000, 1)
IDEF(sbc_2,  0x0FF00010, 0x00C00000, 1)
IDEF(sbc_2s, 0x0FF00010, 0x00D00000, 1)
IDEF(sbc_3,  0x0FF00090, 0x00C00010, 1)
IDEF(sbc_3s, 0x0FF00090, 0x00D00010, 1)

IDEF(rsc_1,  0x0FF00000, 0x02E00000, 1)
IDEF(rsc_1s, 0x0FF00000, 0x02F00000, 1)
IDEF(rsc_2,  0x0FF00010, 0x00E00000, 1)
IDEF(rsc_2s, 0x0FF00010, 0x00F00000, 1)
IDEF(rsc_3,  0x0FF00090, 0x00E00010, 1)
IDEF(rsc_3s, 0x0FF00090, 0x00F00010, 1)

IDEF(tst_1s, 0x0FF00000, 0x03100000, 1)
IDEF(tst_2s, 0x0FF00010, 0x01100000, 1)
IDEF(tst_3s, 0x0FF00090, 0x01100010, 1)

IDEF(teq_1s, 0x0FF00000, 0x03300000, 1)
IDEF(teq_2s, 0x0FF00010, 0x01300000, 1)
IDEF(teq_3s, 0x0FF00090, 0x01300010, 1)

IDEF(cmp_1s, 0x0FF00000, 0x03500000, 1)
IDEF(cmp_2s, 0x0FF00010, 0x01500000, 1)
IDEF(cmp_3s, 0x0FF00090, 0x01500010, 1)

IDEF(cmn_1s, 0x0FF00000, 0x03700000, 1)
IDEF(cmn_2s, 0x0FF00010, 0x01700000, 1)
IDEF(cmn_3s, 0x0FF00090, 0x01700010, 1)

IDEF(orr_1,  0x0FF00000, 0x03800000, 1)
IDEF(orr_1s, 0x0FF00000, 0x03900000, 1)
IDEF(orr_2,  0x0FF00010, 0x01800000, 1)
IDEF(orr_2s, 0x0FF00010, 0x01900000, 1)
IDEF(orr_3,  0x0FF00090, 0x01800010, 1)
IDEF(orr_3s, 0x0FF00090, 0x01900010, 1)

IDEF(mov_1,  0x0FF00000, 0x03A00000, 1)
IDEF(mov_1s, 0x0FF00000, 0x03B00000, 1)
IDEF(mov_2,  0x0FF00010, 0x01A00000, 1)
IDEF(mov_2s, 0x0FF00010, 0x01B00000, 1)
IDEF(mov_3,  0x0FF00090, 0x01A00010, 1)
IDEF(mov_3s, 0x0FF00090, 0x01B00010, 1)

IDEF(bic_1,  0x0FF00000, 0x03C00000, 1)
IDEF(bic_1s, 0x0FF00000, 0x03D00000, 1)
IDEF(bic_2,  0x0FF00010, 0x01C00000, 1)
IDEF(bic_2s, 0x0FF00010, 0x01D00000, 1)
IDEF(bic_3,  0x0FF00090, 0x01C00010, 1)
IDEF(bic_3s, 0x0FF00090, 0x01D00010, 1)

IDEF(mvn_1,  0x0FF00000, 0x03E00000, 1)
IDEF(mvn_1s, 0x0FF00000, 0x03F00000, 1)
IDEF(mvn_2,  0x0FF00010, 0x01E00000, 1)
IDEF(mvn_2s, 0x0FF00010, 0x01F00000, 1)
IDEF(mvn_3,  0x0FF00090, 0x01E00010, 1)
IDEF(mvn_3s, 0x0FF00090, 0x01F00010, 1)

IDEF(branch,           0x0F000000, 0x0A000000, 1)
IDEF(branch_link,      0x0F000000, 0x0B000000, 1)
IDEF(branch_exchange,  0x0FFFFFF0, 0x012FFF10, 1)
IDEF(blx,              0x0FFFFFF0, 0x012FFF30, 1)

IDEF(ld1_imm,   0x0F500000, 0x04100000, 1)
IDEF(ld1_imm_p, 0x0F500000, 0x05100000, 1)
IDEF(ld1_imm_b, 0x0F500000, 0x04500000, 1)
IDEF(ld1_imm_pb,0x0F500000, 0x05500000, 1)

IDEF(ld1_reg,   0x0F500010, 0x06100000, 1)
IDEF(ld1_reg_p, 0x0F500010, 0x07100000, 1)
IDEF(ld1_reg_b, 0x0F500010, 0x06500000, 1)
IDEF(ld1_reg_pb,0x0F500010, 0x07500000, 1)

IDEF(ld2_imm, 0x0E5000F0, 0x005000B0, 1)
IDEF(ld2_imm, 0x0E5000F0, 0x005000D0, 1)
IDEF(ld2_imm, 0x0E5000F0, 0x005000F0, 1)
IDEF(ld2_reg, 0x0E500FF0, 0x001000B0, 1)
IDEF(ld2_reg, 0x0E500FF0, 0x001000D0, 1)
IDEF(ld2_reg, 0x0E500FF0, 0x001000F0, 1)

IDEF(st1_imm,   0x0F500000, 0x04000000, 1)
IDEF(st1_imm_p, 0x0F500000, 0x05000000, 1)
IDEF(st1_imm_b, 0x0F500000, 0x04400000, 1)
IDEF(st1_imm_pb,0x0F500000, 0x05400000, 1)

IDEF(st1_reg,   0x0F500010, 0x06000000, 1)
IDEF(st1_reg_p, 0x0F500010, 0x07000000, 1)
IDEF(st1_reg_b, 0x0F500010, 0x06400000, 1)
IDEF(st1_reg_pb,0x0F500010, 0x07400000, 1)

IDEF(st2_imm, 0x0E5000F0, 0x004000B0, 1)
IDEF(st2_reg, 0x0E500FF0, 0x000000B0, 1)

IDEF(swap,     0x0FF00FF0, 0x01000090, 1)
IDEF(swap_byte,0x0FF00FF0, 0x01400090, 1)

IDEF(ldm, 0x0E100000, 0x08100000, 1)
IDEF(stm, 0x0E100000, 0x08000000, 1)

IDEF(mla,  0x0FF000F0, 0x00200090, 1)
IDEF(mla_s,0x0FF000F0, 0x00300090, 1)

IDEF(mul,  0x0FF000F0, 0x00000090, 1)
IDEF(mul_s,0x0FF000F0, 0x00100090, 1)

IDEF(smull,  0x0FF000F0, 0x00C00090, 1)
IDEF(smull_s,0x0FF000F0, 0x00D00090, 1)

IDEF(smlal,  0x0FF000F0, 0x00E00090, 1)
IDEF(smlal_s,0x0FF000F0, 0x00F00090, 1)

IDEF(umull,  0x0FF000F0, 0x00800090, 1)
IDEF(umull_s,0x0FF000F0, 0x00900090, 1)

IDEF(umlal,  0x0FF000F0, 0x00A00090, 1)
IDEF(umlal_s,0x0FF000F0, 0x00B00090, 1)

IDEF(mrs,   0x0FFF0FFF, 0x010F0000, 1)
IDEF(mrs_r, 0x0FFF0FFF, 0x014F0000, 1)

IDEF(msr_1, 0x0FF0F000, 0x0320F000, 1)
IDEF(msr_1r,0x0FF0F000, 0x0360F000, 1)

IDEF(msr_2, 0x0FF0FFF0, 0x0120F000, 1)
IDEF(msr_2r,0x0FF0FFF0, 0x0160F000, 1)

IDEF(cdp, 0x0F000010, 0x0E000000, 1)
IDEF(mcr, 0x0F100010, 0x0E000010, 1)
IDEF(mrc, 0x0F100010, 0x0E100010, 1)
IDEF(ldc, 0x0E100000, 0x0C100000, 1)
IDEF(stc, 0x0E100000, 0x0C000000, 1)

IDEF(sc, 0x0F000000, 0x0F000000, 1)

IDEF(mra, 0x0FF00FFF, 0x0C500000, 1)
IDEF(mar, 0x0FF00FFF, 0x0C400000, 1)
IDEF(clz, 0x0FFF0FF0, 0x016F0F10, 1)

IDEF(ldd_imm, 	0x0E5000F0,	0x004000D0, 1)
IDEF(ldd_reg, 	0x0E500FF0,	0x000000D0, 1)

IDEF(std_imm,	0x0E5000F0, 0x004000F0, 1)
IDEF(std_reg,	0x0E500FF0, 0x000000F0, 1)

IDEF(qadd,	0x0FF00FF0, 0x01000050, 1)
IDEF(qdadd, 0x0FF00FF0, 0x01400050, 1)
IDEF(qsub, 	0x0FF00FF0, 0x01200050, 1)
IDEF(qdsub, 0x0FF00FF0, 0x01600050, 1)

IDEF(smla_xy, 	0x0FF00090, 0x01000080, 1)
IDEF(smlal_xy,	0x0FF00090, 0x01400080, 1)
IDEF(smlaw_y, 	0x0FF000B0, 0x01200080, 1)
IDEF(smul_xy, 	0x0FF0F090, 0x01600080, 1)
IDEF(smulw_y, 	0x0FF0F0B0, 0x01200080, 1)

#undef IDEF
